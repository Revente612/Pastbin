<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PastBin - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ö–æ—Å—Ç–∏–Ω–≥</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #000000;
            color: #e0e0e0;
            line-height: 1.6;
            min-height: 100vh;
        }

        .hidden {
            display: none !important;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å */
        .navbar {
            background-color: #111111;
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 20px rgba(0,0,0,0.8);
            border-bottom: 1px solid #222;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .nav-logo h1 {
            font-size: 1.8rem;
            color: #ff4444;
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.3);
            cursor: pointer;
        }

        .nav-search {
            display: flex;
            gap: 0.5rem;
            flex: 1;
            max-width: 400px;
            margin: 0 2rem;
        }

        .nav-search input {
            padding: 0.5rem 1rem;
            border: 1px solid #222;
            border-radius: 25px;
            background-color: #111;
            color: #e0e0e0;
            flex: 1;
        }

        .nav-search input:focus {
            outline: none;
            border-color: #ff4444;
            box-shadow: 0 0 10px rgba(255, 68, 68, 0.2);
        }

        .nav-search button, .nav-auth button {
            padding: 0.5rem 1.5rem;
            background: linear-gradient(135deg, #ff4444, #cc3333);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            white-space: nowrap;
        }

        .nav-search button:hover, .nav-auth button:hover {
            background: linear-gradient(135deg, #ff5555, #dd4444);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 68, 68, 0.3);
        }

        #addPasteBtn {
            font-size: 1.5rem;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #00c851, #007e33);
            border-radius: 50%;
        }

        #addPasteBtn:hover {
            background: linear-gradient(135deg, #00d855, #008f3a);
        }

        .nav-auth {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        #telegramBtn {
            background: linear-gradient(135deg, #0088cc, #006699);
        }

        #telegramBtn:hover {
            background: linear-gradient(135deg, #0099dd, #0077aa);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: #111;
            border-radius: 20px;
            border: 1px solid #222;
            cursor: pointer;
            position: relative;
        }

        .user-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: #111;
            border: 1px solid #222;
            border-radius: 10px;
            padding: 0.5rem;
            min-width: 200px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .user-menu-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            border-radius: 5px;
            transition: background 0.3s;
        }

        .user-menu-item:hover {
            background: #222;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #ff4444;
            background: #333;
        }

        .scoin-balance {
            background: linear-gradient(135deg, #ffd700, #ff6b00);
            color: #000;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .premium-badge {
            background: linear-gradient(135deg, #ffd700, #ff6b00);
            color: #000;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }

        .admin-badge {
            background: linear-gradient(135deg, #ff4444, #cc0000);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .welcome-section, .auth-section, .profile-section, .shop-section, .messenger-section, .edit-profile-section, .posts-section, .calendar-section {
            background: #111;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            margin-bottom: 2rem;
            border: 1px solid #222;
            position: relative;
            overflow: hidden;
        }

        .welcome-section::before, .auth-section::before, .profile-section::before, .shop-section::before, .messenger-section::before, .edit-profile-section::before, .posts-section::before, .calendar-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ff4444, #ffaa00, #ff4444);
        }

        .welcome-section h2, .auth-section h2, .profile-section h2, .shop-section h2, .messenger-section h2, .edit-profile-section h2, .posts-section h2, .calendar-section h2 {
            margin-bottom: 1rem;
            color: #ff4444;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        /* –ü—Ä–æ—Ñ–∏–ª—å */
        .profile-header {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 2rem;
            padding: 2rem;
            background: linear-gradient(135deg, #1a1a1a, #2a1a2a);
            border-radius: 15px;
            position: relative;
        }

        .profile-avatar-container {
            position: relative;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #ff4444;
            background: #333;
        }

        .change-avatar-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: #ff4444;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-info {
            flex: 1;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat-item {
            background: #151515;
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #aaa;
        }

        /* –ü–æ–¥–∞—Ä–∫–∏ –≤ –ø—Ä–æ—Ñ–∏–ª–µ */
        .profile-gifts-section {
            margin-top: 2rem;
        }

        .gifts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .gift-card {
            background: #151515;
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            border: 1px solid #222;
            transition: transform 0.3s;
        }

        .gift-card:hover {
            transform: translateY(-5px);
        }

        .gift-emoji {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .gift-name {
            font-size: 0.8rem;
            color: #ffaa00;
            margin-bottom: 0.25rem;
        }

        .gift-count {
            font-size: 0.7rem;
            color: #aaa;
        }

        .gift-level {
            font-size: 0.7rem;
            color: #ff4444;
            margin-top: 0.25rem;
        }

        /* –ú–∞–≥–∞–∑–∏–Ω */
        .shop-categories {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid #222;
            flex-wrap: wrap;
        }

        .shop-category {
            padding: 1rem 2rem;
            background: transparent;
            border: none;
            color: #aaa;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .shop-category.active {
            color: #ff4444;
            border-bottom-color: #ff4444;
        }

        .shop-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .shop-item {
            background: #151515;
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid #222;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .shop-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(255, 68, 68, 0.2);
        }

        .shop-item-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 1rem;
            background: #222;
        }

        .shop-item-name {
            font-size: 1.2rem;
            color: #ff4444;
            margin-bottom: 0.5rem;
        }

        .shop-item-price {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #ffd700;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .shop-item-description {
            color: #aaa;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        /* –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä */
        .messenger-container {
            display: flex;
            height: 600px;
            border: 1px solid #222;
            border-radius: 10px;
            overflow: hidden;
        }

        .contacts-list {
            width: 300px;
            background: #151515;
            border-right: 1px solid #222;
            overflow-y: auto;
        }

        .contact {
            padding: 1rem;
            border-bottom: 1px solid #222;
            cursor: pointer;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .contact:hover, .contact.active {
            background: #222;
        }

        .contact-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            background: #333;
        }

        .contact-info {
            flex: 1;
        }

        .contact-name {
            font-weight: bold;
            color: #ff4444;
        }

        .contact-status {
            font-size: 0.8rem;
            color: #aaa;
        }

        .search-contacts {
            padding: 1rem;
            border-bottom: 1px solid #222;
        }

        .search-contacts input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #222;
            border-radius: 20px;
            background: #1a1a1a;
            color: #e0e0e0;
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 1rem;
            background: #151515;
            border-bottom: 1px solid #222;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .chat-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            background: #333;
        }

        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            max-width: 70%;
            padding: 0.75rem 1rem;
            border-radius: 15px;
            position: relative;
        }

        .message.sent {
            align-self: flex-end;
            background: #ff4444;
            border-bottom-right-radius: 5px;
        }

        .message.received {
            align-self: flex-start;
            background: #222;
            border-bottom-left-radius: 5px;
        }

        .message-sender {
            font-size: 0.8rem;
            color: #aaa;
            margin-bottom: 0.25rem;
        }

        .message-text {
            word-wrap: break-word;
        }

        .message-time {
            font-size: 0.7rem;
            color: #888;
            text-align: right;
            margin-top: 0.25rem;
        }

        .chat-input {
            display: flex;
            padding: 1rem;
            background: #151515;
            border-top: 1px solid #222;
            gap: 0.5rem;
        }

        .chat-input input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #222;
            border-radius: 25px;
            background: #1a1a1a;
            color: #e0e0e0;
        }

        .chat-input button {
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
        }

        /* –ü–æ—Å—Ç—ã */
        .posts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .post-card {
            background: #151515;
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid #222;
            transition: transform 0.3s;
        }

        .post-card:hover {
            transform: translateY(-5px);
        }

        .post-title {
            font-size: 1.2rem;
            color: #ff4444;
            margin-bottom: 0.5rem;
        }

        .post-content {
            color: #aaa;
            margin-bottom: 1rem;
            max-height: 100px;
            overflow: hidden;
        }

        .post-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #666;
        }

        /* –ö–∞–ª–µ–Ω–¥–∞—Ä—å */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
            margin-top: 1.5rem;
        }

        .calendar-day {
            background: #151515;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            border: 1px solid #222;
            transition: all 0.3s;
            cursor: pointer;
        }

        .calendar-day.claimed {
            background: linear-gradient(135deg, #00c851, #007e33);
            color: white;
        }

        .calendar-day.available {
            background: linear-gradient(135deg, #ffd700, #ff6b00);
            color: #000;
            font-weight: bold;
        }

        .calendar-day.future {
            background: #222;
            color: #666;
            cursor: not-allowed;
        }

        .day-number {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .day-reward {
            font-size: 0.8rem;
        }

        /* –§–æ—Ä–º—ã */
        form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        input, textarea, select {
            padding: 1rem;
            border: 1px solid #222;
            border-radius: 8px;
            font-size: 1rem;
            background: #1a1a1a;
            color: #e0e0e0;
            transition: all 0.3s;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #ff4444;
            box-shadow: 0 0 15px rgba(255, 68, 68, 0.2);
        }

        button {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #ff4444, #cc3333);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        button:hover {
            background: linear-gradient(135deg, #ff5555, #dd4444);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 68, 68, 0.3);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #666, #444);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #777, #555);
        }

        .btn-premium {
            background: linear-gradient(135deg, #ffd700, #ff6b00);
            color: #000;
        }

        .btn-premium:hover {
            background: linear-gradient(135deg, #ffed4e, #ff8c00);
        }

        a {
            color: #ffaa00;
            text-decoration: none;
            transition: color 0.3s;
        }

        a:hover {
            color: #ffcc00;
            text-decoration: underline;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: #111;
            padding: 2rem;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid #222;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .close {
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 2rem;
            cursor: pointer;
            color: #aaa;
            transition: color 0.3s;
        }

        .close:hover {
            color: #ff4444;
        }

        /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–µ–π–¥–∂ –∫—Ä–æ–≤–∏ */
        .blood-badge {
            display: inline-block;
            animation: bloodPulse 2s infinite;
        }

        @keyframes bloodPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-search {
                width: 100%;
                max-width: none;
                margin: 0;
            }
            
            .container {
                margin: 1rem auto;
            }
            
            .profile-header {
                flex-direction: column;
                text-align: center;
            }
            
            .shop-items, .posts-grid {
                grid-template-columns: 1fr;
            }
            
            .gifts-grid {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
            
            .messenger-container {
                flex-direction: column;
                height: 700px;
            }
            
            .contacts-list {
                width: 100%;
                height: 200px;
                border-right: none;
                border-bottom: 1px solid #222;
            }
            
            .calendar-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .shop-item, .gift-item, .post-card {
            animation: fadeIn 0.5s ease-out;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–∫—É–ø–∫–∏ */
        @keyframes coinAnimation {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .coin-animation {
            animation: coinAnimation 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h1><i class="fas fa-skull-crossbones"></i> PastBin</h1>
            </div>
            <div class="nav-search">
                <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ ID –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É...">
                <button id="searchBtn"><i class="fas fa-search"></i> –ù–∞–π—Ç–∏</button>
            </div>
            <div class="nav-auth">
                <button id="telegramBtn"><i class="fab fa-telegram"></i> AttackPsychos</button>
                <div id="userInfo" class="user-info hidden">
                    <img id="userAvatarImg" class="user-avatar" src="" alt="Avatar">
                    <span id="userName"></span>
                    <span id="premiumBadge" class="premium-badge hidden"><i class="fas fa-crown"></i> –ü–†–ï–ú–ò–£–ú</span>
                    <span id="adminBadge" class="admin-badge hidden"><i class="fas fa-check-circle"></i> –ê–î–ú–ò–ù</span>
                    <div class="scoin-balance">
                        <i class="fas fa-coins"></i>
                        <span id="scoinBalance">0</span>
                    </div>
                    <div id="userMenu" class="user-menu hidden">
                        <div class="user-menu-item" onclick="showProfile()">
                            <i class="fas fa-user"></i> –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å
                        </div>
                        <div class="user-menu-item" onclick="showEditProfile()">
                            <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                        </div>
                        <div class="user-menu-item" onclick="showPosts()">
                            <i class="fas fa-file-alt"></i> –ú–æ–∏ –ø–æ—Å—Ç—ã
                        </div>
                        <div class="user-menu-item" onclick="showShop()">
                            <i class="fas fa-shopping-cart"></i> –ú–∞–≥–∞–∑–∏–Ω
                        </div>
                        <div class="user-menu-item" onclick="showMessenger()">
                            <i class="fas fa-comments"></i> –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä
                        </div>
                        <div class="user-menu-item" onclick="showCalendar()">
                            <i class="fas fa-calendar-alt"></i> –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å
                        </div>
                        <div class="user-menu-item" onclick="showAccountsModal()">
                            <i class="fas fa-exchange-alt"></i> –°–º–µ–Ω–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç
                        </div>
                        <div id="adminPanelItem" class="user-menu-item hidden" onclick="showAdminPanel()">
                            <i class="fas fa-crown"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                        </div>
                        <div class="user-menu-item" onclick="logout()" style="color: #ff4444;">
                            <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                        </div>
                    </div>
                </div>
                <button id="loginBtn">–í–æ–π—Ç–∏</button>
                <button id="registerBtn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                <button id="addPasteBtn" class="hidden">+</button>
                <button id="logoutBtn" class="hidden" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>
        </div>
    </nav>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="container">
        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
        <section id="loginSection" class="auth-section hidden">
            <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginUsername">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" id="loginUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="loginPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>
                <button type="submit">–í–æ–π—Ç–∏</button>
            </form>
            <p style="margin-top: 1rem;">
                –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="showRegister()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a>
            </p>
            <div style="margin-top: 2rem; padding: 1rem; background: #151515; border-radius: 8px; border: 1px solid #333;">
                <h3 style="color: #ffd700;">–ü—Ä–∏–≤–µ—Ç!</h3>
                <p style="color: #aaa; font-size: 0.9rem;">–î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç:</p>
                <p><strong>–õ–æ–≥–∏–Ω:</strong> –í–∞—à –ª–æ–≥–∏–Ω</p>
                <p><strong>–ü–∞—Ä–æ–ª—å:</strong> –í–∞—à –ø–∞—Ä–æ–ª—å</p>
            </div>
        </section>

        <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <section id="registerSection" class="auth-section hidden">
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <form id="registerForm">
                <div class="form-group">
                    <label for="registerUsername">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" id="registerUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="registerPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>
                <div class="form-group">
                    <label for="registerPhone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</label>
                    <input type="text" id="registerPhone" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–π –Ω–æ–º–µ—Ä" required>
                </div>
                <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </form>
            <p style="margin-top: 1rem;">
                –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" onclick="showLogin()">–í–æ–π–¥–∏—Ç–µ</a>
            </p>
        </section>

        <!-- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è -->
        <section id="editProfileSection" class="edit-profile-section hidden">
            <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h2>
            <form id="editProfileForm">
                <div class="form-group">
                    <label>–ê–≤–∞—Ç–∞—Ä:</label>
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <img id="editAvatarPreview" class="user-avatar" src="" alt="Avatar" style="width: 80px; height: 80px;">
                        <input type="file" id="editAvatar" accept="image/*" style="flex: 1;">
                    </div>
                </div>
                <div class="form-group">
                    <label for="editUsername">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" id="editUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                </div>
                <div class="form-group">
                    <label for="editPhone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</label>
                    <input type="text" id="editPhone" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –Ω–æ–º–µ—Ä">
                </div>
                <div class="form-group">
                    <label for="editBio">–û —Å–µ–±–µ:</label>
                    <textarea id="editBio" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ" rows="3"></textarea>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                    <button type="button" class="btn-secondary" onclick="showProfile()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </section>

        <!-- –ú–∞–≥–∞–∑–∏–Ω -->
        <section id="shopSection" class="shop-section hidden">
            <h2>–ú–∞–≥–∞–∑–∏–Ω –°–∫–æ–∏–Ω–æ–≤ <span class="scoin-balance" style="font-size: 1rem;">–í–∞—à –±–∞–ª–∞–Ω—Å: <span id="shopScoinBalance">0</span></span></h2>
            
            <div class="shop-categories">
                <button class="shop-category active" data-category="gifts">–ü–æ–¥–∞—Ä–∫–∏</button>
                <button class="shop-category" data-category="badges">–ë–µ–π–¥–∂–∏</button>
                <button class="shop-category" data-category="special">–û—Å–æ–±—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã</button>
                <button class="shop-category" data-category="premium">–ü—Ä–µ–º–∏—É–º</button>
            </div>

            <div id="shopItemsContainer" class="shop-items">
                <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
            </div>
        </section>

        <!-- –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä -->
        <section id="messengerSection" class="messenger-section hidden">
            <h2>–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</h2>
            <div class="messenger-container">
                <div class="contacts-list">
                    <div class="search-contacts">
                        <input type="text" id="searchContacts" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...">
                    </div>
                    <div id="contactsList">
                        <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                </div>
                <div class="chat-area">
                    <div class="chat-header" id="chatHeader">
                        <img id="chatAvatar" class="chat-avatar" src="" alt="Avatar">
                        <div>
                            <div id="chatUserName">–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç –¥–ª—è –æ–±—â–µ–Ω–∏—è</div>
                            <div id="chatUserStatus" class="contact-status">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–æ–Ω—Ç–∞–∫—Ç –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è</div>
                        </div>
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                    <div class="chat-input">
                        <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." disabled>
                        <button id="sendMessageBtn" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- –ü–æ—Å—Ç—ã -->
        <section id="postsSection" class="posts-section hidden">
            <h2>–ú–æ–∏ –ø–æ—Å—Ç—ã</h2>
            <button id="createPostBtn" onclick="showCreatePostModal()" style="margin-bottom: 1.5rem;">
                <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç
            </button>
            <div id="postsContainer" class="posts-grid">
                <!-- –ü–æ—Å—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
            </div>
        </section>

        <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
        <section id="calendarSection" class="calendar-section hidden">
            <h2>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å</h2>
            <div id="calendarInfo" style="margin-bottom: 1rem; padding: 1rem; background: #151515; border-radius: 8px;">
                <p>–û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –Ω–∞–≥—Ä–∞–¥—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å! –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–µ–º–∏—É–º-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>
            </div>
            <div id="calendarContainer" class="calendar-grid">
                <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å -->
            </div>
        </section>

        <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
        <section id="adminPanelSection" class="shop-section hidden">
            <h2><i class="fas fa-crown"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
            
            <div class="admin-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                <div style="background: #151515; padding: 1.5rem; border-radius: 10px; text-align: center;">
                    <h3 style="color: #ffd700;">–û–±—â–∏–µ —Å–∫–æ–∏–Ω—ã</h3>
                    <p style="font-size: 2rem; font-weight: bold;" id="totalScoins">0</p>
                </div>
                <div style="background: #151515; padding: 1.5rem; border-radius: 10px; text-align: center;">
                    <h3 style="color: #ffd700;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                    <p style="font-size: 2rem; font-weight: bold;" id="totalUsers">0</p>
                </div>
                <div style="background: #151515; padding: 1.5rem; border-radius: 10px; text-align: center;">
                    <h3 style="color: #ffd700;">–°–æ–æ–±—â–µ–Ω–∏—è</h3>
                    <p style="font-size: 2rem; font-weight: bold;" id="totalMessages">0</p>
                </div>
                <div style="background: #151515; padding: 1.5rem; border-radius: 10px; text-align: center;">
                    <h3 style="color: #ffd700;">–ü–æ—Å—Ç—ã</h3>
                    <p style="font-size: 2rem; font-weight: bold;" id="totalPosts">0</p>
                </div>
            </div>

            <div style="background: #151515; padding: 1.5rem; border-radius: 10px; margin-bottom: 2rem;">
                <h3 style="color: #ffd700; margin-bottom: 1rem;">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button onclick="showGiveScoinsModal()"><i class="fas fa-coins"></i> –í—ã–¥–∞—Ç—å —Å–∫–æ–∏–Ω—ã</button>
                    <button onclick="showGivePremiumModal()" class="btn-premium"><i class="fas fa-crown"></i> –í—ã–¥–∞—Ç—å –ø—Ä–µ–º–∏—É–º</button>
                    <button onclick="resetAllData()" style="background: #ff4444;"><i class="fas fa-trash"></i> –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
                    <button onclick="createTestData()" style="background: #00c851;"><i class="fas fa-vial"></i> –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
                </div>
            </div>

            <div style="background: #151515; padding: 1.5rem; border-radius: 10px;">
                <h3 style="color: #ffd700; margin-bottom: 1rem;">–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                <div id="usersList">
                    <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å -->
                </div>
            </div>
        </section>

        <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ -->
        <section id="welcomeSection" class="welcome-section">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ PastBin</h2>
            <p>–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –°–∫–æ–∏–Ω—ã –∑–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Å—Ç –∏ –ø–æ–∫—É–ø–∞–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ!</p>
            <div style="margin-top: 2rem;">
                <button onclick="showLogin()" style="margin-right: 1rem;">–í–æ–π—Ç–∏</button>
                <button onclick="showRegister()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </div>
        </section>

        <!-- –ü—Ä–æ—Ñ–∏–ª—å —Å –ø–æ–¥–∞—Ä–∫–∞–º–∏ -->
        <section id="profileSection" class="profile-section hidden">
            <div class="profile-with-gifts">
                <div class="profile-background" id="profileBackground"></div>
                <div class="profile-content">
                    <div class="profile-header">
                        <div class="profile-avatar-container">
                            <img id="profileAvatar" class="profile-avatar" src="" alt="Avatar">
                            <button class="change-avatar-btn" onclick="showEditProfile()">
                                <i class="fas fa-camera"></i>
                            </button>
                        </div>
                        <div class="profile-info">
                            <h2 id="profileUsername"></h2>
                            <div id="profileBadges"></div>
                            <p id="profileBio" style="margin: 0.5rem 0; color: #aaa;"></p>
                            <p id="profilePhone" style="color: #888;"></p>
                            <button onclick="showEditProfile()" class="btn-secondary" style="margin-top: 1rem;">
                                <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                            </button>
                        </div>
                    </div>

                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="profileScoins">0</div>
                            <div class="stat-label">–°–∫–æ–∏–Ω—ã</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profileGiftsCount">0</div>
                            <div class="stat-label">–ü–æ–¥–∞—Ä–∫–∏</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profileMessagesCount">0</div>
                            <div class="stat-label">–°–æ–æ–±—â–µ–Ω–∏—è</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profilePostsCount">0</div>
                            <div class="stat-label">–ü–æ—Å—Ç—ã</div>
                        </div>
                    </div>

                    <div class="profile-gifts-section">
                        <h3>üéÅ –ú–æ–∏ –ø–æ–¥–∞—Ä–∫–∏</h3>
                        <div id="profileGiftsContainer" class="gifts-grid">
                            <!-- –ü–æ–¥–∞—Ä–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="sendGiftModal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeModal('sendGiftModal')">&times;</span>
            <h2>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫</h2>
            <div id="giftSelection" class="gifts-grid"></div>
            <div class="form-group">
                <label>–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</label>
                <input type="text" id="giftRecipient" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            </div>
            <button onclick="sendGift()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫</button>
        </div>
    </div>

    <div id="giveScoinsModal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeModal('giveScoinsModal')">&times;</span>
            <h2>–í—ã–¥–∞—Ç—å –°–∫–æ–∏–Ω—ã</h2>
            <div class="form-group">
                <label>–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</label>
                <input type="text" id="scoinRecipient" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            </div>
            <div class="form-group">
                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –°–∫–æ–∏–Ω–æ–≤:</label>
                <input type="number" id="scoinAmount" placeholder="100" min="1" max="1000000">
            </div>
            <button onclick="giveScoins()">–í—ã–¥–∞—Ç—å –°–∫–æ–∏–Ω—ã</button>
        </div>
    </div>

    <div id="givePremiumModal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeModal('givePremiumModal')">&times;</span>
            <h2>–í—ã–¥–∞—Ç—å –ü—Ä–µ–º–∏—É–º</h2>
            <div class="form-group">
                <label>–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</label>
                <input type="text" id="premiumRecipient" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            </div>
            <div class="form-group">
                <label>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–µ—Å—è—Ü–µ–≤):</label>
                <input type="number" id="premiumDuration" placeholder="1" min="1" max="12">
            </div>
            <button class="btn-premium" onclick="givePremium()">–í—ã–¥–∞—Ç—å –ü—Ä–µ–º–∏—É–º</button>
        </div>
    </div>

    <div id="accountsModal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeModal('accountsModal')">&times;</span>
            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏</h2>
            <div id="accountsList">
                <!-- –°–ø–∏—Å–æ–∫ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å -->
            </div>
            <div class="form-group">
                <label>–ù–æ–≤—ã–π –Ω–æ–º–µ—Ä:</label>
                <input type="text" id="newPhoneNumber" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–π –Ω–æ–º–µ—Ä">
            </div>
            <div class="form-group">
                <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <input type="text" id="newUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            </div>
            <button onclick="createNewAccount()">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç</button>
        </div>
    </div>

    <div id="createPostModal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeModal('createPostModal')">&times;</span>
            <h2>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Å—Ç</h2>
            <form id="createPostForm">
                <div class="form-group">
                    <label for="postTitle">–ó–∞–≥–æ–ª–æ–≤–æ–∫:</label>
                    <input type="text" id="postTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞" required>
                </div>
                <div class="form-group">
                    <label for="postContent">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:</label>
                    <textarea id="postContent" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞" rows="10" required></textarea>
                </div>
                <button type="submit">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
            </form>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω–∞
        const shopItems = {
            gifts: [
                {
                    id: 'pepe',
                    name: '–ü–ª—é—à–µ–≤—ã–π –ü–µ–ø–µ',
                    price: 30000,
                    emoji: 'üê∏',
                    description: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –ü–ª—é—à–µ–≤—ã–π –ü–µ–ø–µ'
                },
                {
                    id: 'bear',
                    name: '–ú–µ–¥–≤–µ–¥—å',
                    price: 15,
                    emoji: 'üêª',
                    description: '–ú–∏–ª—ã–π –ø–ª—é—à–µ–≤—ã–π –º–µ–¥–≤–µ–¥—å'
                },
                {
                    id: 'rocket',
                    name: '–†–∞–∫–µ—Ç–∞',
                    price: 100,
                    emoji: 'üöÄ',
                    description: '–ë—ã—Å—Ç—Ä–∞—è –∫–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ä–∞–∫–µ—Ç–∞'
                },
                {
                    id: 'map',
                    name: '–ö–∞—Ä—Ç–∞ PastBin',
                    price: 55555,
                    emoji: 'üó∫Ô∏è',
                    description: '–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ PastBin'
                },
                {
                    id: 'durov',
                    name: '–î—É—Ä–æ–≤',
                    price: 4444,
                    emoji: 'üë®‚Äçüíº',
                    description: '–û—Å–Ω–æ–≤–∞—Ç–µ–ª—å Telegram'
                }
            ],
            badges: [
                {
                    id: 'blood',
                    name: '–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–µ–π–¥–∂ –∫—Ä–æ–≤–∏',
                    price: 1000,
                    emoji: '<span class="blood-badge">ü©∏</span>',
                    description: '–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–º–∞–π–ª–∏–∫ –∫—Ä–æ–≤–∏ –¥–ª—è –Ω–∏–∫–∞'
                }
            ],
            special: [
                {
                    id: 'special1',
                    name: '–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω',
                    price: 500,
                    description: '–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω'
                }
            ],
            premium: [
                {
                    id: 'premium1',
                    name: '–ü—Ä–µ–º–∏—É–º –Ω–∞ 1 –º–µ—Å—è—Ü',
                    price: 1000,
                    description: '–î–æ—Å—Ç—É–ø –∫ –ø—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏—è–º –Ω–∞ 1 –º–µ—Å—è—Ü'
                },
                {
                    id: 'premium3',
                    name: '–ü—Ä–µ–º–∏—É–º –Ω–∞ 3 –º–µ—Å—è—Ü–∞',
                    price: 2500,
                    description: '–î–æ—Å—Ç—É–ø –∫ –ø—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏—è–º –Ω–∞ 3 –º–µ—Å—è—Ü–∞'
                },
                {
                    id: 'premium12',
                    name: '–ü—Ä–µ–º–∏—É–º –Ω–∞ 12 –º–µ—Å—è—Ü–µ–≤',
                    price: 8000,
                    description: '–î–æ—Å—Ç—É–ø –∫ –ø—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏—è–º –Ω–∞ 12 –º–µ—Å—è—Ü–µ–≤'
                }
            ]
        };

        // –ù–∞–≥—Ä–∞–¥—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        const calendarRewards = [
            { day: 1, reward: '–ú–∏—à–∫–∞', type: 'gift', value: 'bear' },
            { day: 2, reward: '100 —Å–∫–æ–∏–Ω–æ–≤', type: 'scoins', value: 100 },
            { day: 3, reward: '–ü—Ä–µ–º–∏—É–º –Ω–∞ 1 –º–µ—Å—è—Ü', type: 'premium', value: 1 },
            { day: 4, reward: '3 —Ä–∞–∫–µ—Ç—ã', type: 'gift', value: 'rocket', count: 3 },
            { day: 5, reward: '–ü—Ä–µ–º–∏—É–º –Ω–∞ 3 –º–µ—Å—è—Ü–∞', type: 'premium', value: 3 },
            { day: 6, reward: '300 —Å–∫–æ–∏–Ω–æ–≤', type: 'scoins', value: 300 },
            { day: 7, reward: '10 —Ä–∞–∫–µ—Ç', type: 'gift', value: 'rocket', count: 10 }
        ];

        // –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        let users = JSON.parse(localStorage.getItem('pastbin_users')) || {};
        let userScoins = JSON.parse(localStorage.getItem('pastbin_scoins')) || {};
        let userInventory = JSON.parse(localStorage.getItem('pastbin_inventory')) || {};
        let userGifts = JSON.parse(localStorage.getItem('pastbin_gifts')) || {};
        let userBadges = JSON.parse(localStorage.getItem('pastbin_badges')) || {};
        let userPremium = JSON.parse(localStorage.getItem('pastbin_premium')) || {};
        let userAccounts = JSON.parse(localStorage.getItem('pastbin_accounts')) || {};
        let messages = JSON.parse(localStorage.getItem('pastbin_messages')) || {};
        let userProfiles = JSON.parse(localStorage.getItem('pastbin_user_profiles')) || {};
        let posts = JSON.parse(localStorage.getItem('pastbin_posts')) || {};
        let calendarClaims = JSON.parse(localStorage.getItem('pastbin_calendar')) || {};
        let currentUser = JSON.parse(localStorage.getItem('pastbin_current_user')) || null;
        let currentChat = null;

        // –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ PsychosOwner
        function createAdminUser() {
            if (!users['PsychosOwner']) {
                users['PsychosOwner'] = {
                    password: 'Hash333',
                    phoneNumber: '+79999999999',
                    role: 'admin',
                    createdAt: new Date().toISOString()
                };
                
                userScoins['PsychosOwner'] = 100000;
                userProfiles['PsychosOwner'] = {
                    avatar: '',
                    bio: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã',
                    level: 99
                };
                
                userPremium['PsychosOwner'] = {
                    active: true,
                    expires: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000).toISOString()
                };
                
                const accountId = 'acc_admin';
                userAccounts[accountId] = {
                    id: accountId,
                    phoneNumber: '+79999999999',
                    username: 'PsychosOwner',
                    role: 'admin',
                    createdAt: new Date().toISOString()
                };
                
                saveAllData();
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        function saveAllData() {
            localStorage.setItem('pastbin_users', JSON.stringify(users));
            localStorage.setItem('pastbin_scoins', JSON.stringify(userScoins));
            localStorage.setItem('pastbin_inventory', JSON.stringify(userInventory));
            localStorage.setItem('pastbin_gifts', JSON.stringify(userGifts));
            localStorage.setItem('pastbin_badges', JSON.stringify(userBadges));
            localStorage.setItem('pastbin_premium', JSON.stringify(userPremium));
            localStorage.setItem('pastbin_accounts', JSON.stringify(userAccounts));
            localStorage.setItem('pastbin_messages', JSON.stringify(messages));
            localStorage.setItem('pastbin_user_profiles', JSON.stringify(userProfiles));
            localStorage.setItem('pastbin_posts', JSON.stringify(posts));
            localStorage.setItem('pastbin_calendar', JSON.stringify(calendarClaims));
            if (currentUser) {
                localStorage.setItem('pastbin_current_user', JSON.stringify(currentUser));
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
        function showLogin() {
            hideAllSections();
            document.getElementById('loginSection').classList.remove('hidden');
        }

        function showRegister() {
            hideAllSections();
            document.getElementById('registerSection').classList.remove('hidden');
        }

        function showWelcome() {
            hideAllSections();
            document.getElementById('welcomeSection').classList.remove('hidden');
        }

        function showShop() {
            hideAllSections();
            document.getElementById('shopSection').classList.remove('hidden');
            updateScoinDisplay();
            showShopCategory('gifts');
        }

        function showProfile() {
            hideAllSections();
            document.getElementById('profileSection').classList.remove('hidden');
            updateProfileDisplay();
        }

        function showEditProfile() {
            hideAllSections();
            document.getElementById('editProfileSection').classList.remove('hidden');
            loadEditProfileForm();
        }

        function showMessenger() {
            hideAllSections();
            document.getElementById('messengerSection').classList.remove('hidden');
            loadContacts();
        }

        function showPosts() {
            hideAllSections();
            document.getElementById('postsSection').classList.remove('hidden');
            loadUserPosts();
        }

        function showCalendar() {
            hideAllSections();
            document.getElementById('calendarSection').classList.remove('hidden');
            loadCalendar();
        }

        function showAdminPanel() {
            if (!currentUser || users[currentUser.username]?.role !== 'admin') {
                showNotification('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!', true);
                return;
            }
            hideAllSections();
            document.getElementById('adminPanelSection').classList.remove('hidden');
            updateAdminPanel();
        }

        function hideAllSections() {
            document.getElementById('welcomeSection').classList.add('hidden');
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('registerSection').classList.add('hidden');
            document.getElementById('shopSection').classList.add('hidden');
            document.getElementById('profileSection').classList.add('hidden');
            document.getElementById('editProfileSection').classList.add('hidden');
            document.getElementById('messengerSection').classList.add('hidden');
            document.getElementById('postsSection').classList.add('hidden');
            document.getElementById('calendarSection').classList.add('hidden');
            document.getElementById('adminPanelSection').classList.add('hidden');
            document.getElementById('userMenu').classList.add('hidden');
        }

        function login(username, password) {
            if (!users[username]) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!', true);
                return false;
            }

            if (users[username].password !== password) {
                showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', true);
                return false;
            }

            currentUser = {
                username: username,
                phoneNumber: users[username].phoneNumber,
                role: users[username].role
            };
            
            localStorage.setItem('pastbin_current_user', JSON.stringify(currentUser));
            initUserData(username);
            updateUIForUser();
            showWelcome();
            showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${username}!`);
            return true;
        }

        function register(username, password, phoneNumber) {
            if (users[username]) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', true);
                return false;
            }

            const existingUser = Object.values(users).find(user => user.phoneNumber === phoneNumber);
            if (existingUser) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –Ω–æ–º–µ—Ä–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', true);
                return false;
            }

            users[username] = {
                password: password,
                phoneNumber: phoneNumber,
                role: 'user',
                createdAt: new Date().toISOString()
            };

            userProfiles[username] = {
                avatar: '',
                bio: '',
                level: 1
            };

            const accountId = 'acc_' + Date.now();
            userAccounts[accountId] = {
                id: accountId,
                phoneNumber: phoneNumber,
                username: username,
                role: 'user',
                createdAt: new Date().toISOString()
            };

            initUserData(username);
            saveAllData();
            showNotification(`–ê–∫–∫–∞—É–Ω—Ç ${username} —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!`);
            showLogin();
            return true;
        }

        function initUserData(username) {
            if (!userScoins[username]) userScoins[username] = 100;
            if (!userInventory[username]) userInventory[username] = [];
            if (!userGifts[username]) userGifts[username] = [];
            if (!userBadges[username]) userBadges[username] = [];
            if (!userPremium[username]) userPremium[username] = { active: false, expires: null };
            if (!userProfiles[username]) userProfiles[username] = { avatar: '', bio: '', level: 1 };
            if (!messages[username]) messages[username] = {};
            if (!posts[username]) posts[username] = [];
            if (!calendarClaims[username]) calendarClaims[username] = { lastClaim: null, claimedDays: [] };
            saveAllData();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function updateUIForUser() {
            if (currentUser) {
                const username = currentUser.username;
                document.getElementById('userName').textContent = username;
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('loginBtn').classList.add('hidden');
                document.getElementById('registerBtn').classList.add('hidden');
                document.getElementById('addPasteBtn').classList.remove('hidden');
                document.getElementById('logoutBtn').classList.remove('hidden');
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞
                const avatar = userProfiles[username]?.avatar || '';
                document.getElementById('userAvatarImg').src = avatar || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjIwIiB5PSIyMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+8J+OujwvdGV4dD4KPC9zdmc+';
                
                const isAdmin = users[username]?.role === 'admin';
                const isPremium = userPremium[username]?.active || false;
                
                document.getElementById('adminBadge').classList.toggle('hidden', !isAdmin);
                document.getElementById('premiumBadge').classList.toggle('hidden', !isPremium);
                document.getElementById('adminPanelItem').classList.toggle('hidden', !isAdmin);
                
                updateScoinDisplay();
            } else {
                document.getElementById('userInfo').classList.add('hidden');
                document.getElementById('loginBtn').classList.remove('hidden');
                document.getElementById('registerBtn').classList.remove('hidden');
                document.getElementById('addPasteBtn').classList.add('hidden');
                document.getElementById('logoutBtn').classList.add('hidden');
            }
        }

        function updateScoinDisplay() {
            if (currentUser) {
                const balance = userScoins[currentUser.username] || 0;
                document.getElementById('scoinBalance').textContent = balance;
                document.getElementById('shopScoinBalance').textContent = balance;
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
        function updateProfileDisplay() {
            if (!currentUser) return;
            
            const username = currentUser.username;
            const profile = userProfiles[username] || {};
            const userData = users[username];
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            document.getElementById('profileUsername').textContent = username;
            document.getElementById('profilePhone').textContent = `üì± ${userData.phoneNumber}`;
            document.getElementById('profileBio').textContent = profile.bio || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–∏–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ';
            document.getElementById('profileScoins').textContent = userScoins[username] || 0;
            document.getElementById('profileLevel').textContent = profile.level || 1;
            
            // –ê–≤–∞—Ç–∞—Ä
            const avatar = profile.avatar || '';
            document.getElementById('profileAvatar').src = avatar || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDEyMCAxMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjYwIiB5PSI2MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjQ4IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+8J+OujwvdGV4dD4KPC9zdmc+';
            
            // –ë–µ–π–¥–∂–∏
            const badgesContainer = document.getElementById('profileBadges');
            badgesContainer.innerHTML = '';
            
            if (userData.role === 'admin') {
                badgesContainer.innerHTML += '<span class="admin-badge"><i class="fas fa-check-circle"></i> –ê–î–ú–ò–ù</span>';
            }
            
            if (userPremium[username]?.active) {
                badgesContainer.innerHTML += '<span class="premium-badge"><i class="fas fa-crown"></i> –ü–†–ï–ú–ò–£–ú</span>';
            }
            
            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –±–µ–π–¥–∂–∏
            const userBadgeList = userBadges[username] || [];
            userBadgeList.forEach(badge => {
                if (badge.id === 'blood') {
                    badgesContainer.innerHTML += '<span class="blood-badge" style="margin-left: 0.5rem;">ü©∏</span>';
                }
            });
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
            const messagesCount = Object.values(messages[username] || {}).reduce((sum, chat) => sum + chat.length, 0);
            document.getElementById('profileMessagesCount').textContent = messagesCount;
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å—Ç–æ–≤
            const postsCount = posts[username]?.length || 0;
            document.getElementById('profilePostsCount').textContent = postsCount;
            
            // –ü–æ–¥–∞—Ä–∫–∏
            updateProfileGifts();
        }

        function updateProfileGifts() {
            if (!currentUser) return;
            
            const container = document.getElementById('profileGiftsContainer');
            const gifts = userGifts[currentUser.username] || [];
            const giftCounts = {};
            
            // –ü–æ–¥—Å—á–µ—Ç –ø–æ–¥–∞—Ä–∫–æ–≤
            gifts.forEach(gift => {
                const key = gift.id;
                if (!giftCounts[key]) {
                    giftCounts[key] = { count: 0, gift: gift };
                }
                giftCounts[key].count++;
            });
            
            container.innerHTML = '';
            
            Object.values(giftCounts).forEach(({gift, count}) => {
                const shopItem = shopItems.gifts.find(item => item.id === gift.id) || 
                               shopItems.badges.find(item => item.id === gift.id);
                
                if (shopItem) {
                    const giftElement = document.createElement('div');
                    giftElement.className = 'gift-card';
                    giftElement.innerHTML = `
                        <div class="gift-emoji">${shopItem.emoji}</div>
                        <div class="gift-name">${shopItem.name}</div>
                        <div class="gift-count">√ó${count}</div>
                    `;
                    container.appendChild(giftElement);
                }
            });
            
            document.getElementById('profileGiftsCount').textContent = gifts.length;
            
            if (gifts.length === 0) {
                container.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #aaa;">–ü–æ–∫–∞ –Ω–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø–æ–¥–∞—Ä–∫–æ–≤</p>';
            }
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
        function loadEditProfileForm() {
            if (!currentUser) return;
            
            const username = currentUser.username;
            const profile = userProfiles[username] || {};
            const userData = users[username];
            
            document.getElementById('editUsername').value = username;
            document.getElementById('editPhone').value = userData.phoneNumber;
            document.getElementById('editBio').value = profile.bio || '';
            
            const avatarPreview = document.getElementById('editAvatarPreview');
            avatarPreview.src = profile.avatar || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjQwIiB5PSI0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjMyIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+8J+OujwvdGV4dD4KPC9zdmc+';
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞
            document.getElementById('editAvatar').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        avatarPreview.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        function saveProfileChanges() {
            if (!currentUser) return;
            
            const username = currentUser.username;
            const newUsername = document.getElementById('editUsername').value.trim();
            const newPhone = document.getElementById('editPhone').value.trim();
            const newBio = document.getElementById('editBio').value.trim();
            const avatarFile = document.getElementById('editAvatar').files[0];
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (newUsername && newUsername !== username) {
                if (users[newUsername]) {
                    showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', true);
                    return false;
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                users[newUsername] = users[username];
                delete users[username];
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                userScoins[newUsername] = userScoins[username];
                delete userScoins[username];
                
                userInventory[newUsername] = userInventory[username];
                delete userInventory[username];
                
                userGifts[newUsername] = userGifts[username];
                delete userGifts[username];
                
                userBadges[newUsername] = userBadges[username];
                delete userBadges[username];
                
                userPremium[newUsername] = userPremium[username];
                delete userPremium[username];
                
                userProfiles[newUsername] = userProfiles[username];
                delete userProfiles[username];
                
                messages[newUsername] = messages[username];
                delete messages[username];
                
                posts[newUsername] = posts[username];
                delete posts[username];
                
                calendarClaims[newUsername] = calendarClaims[username];
                delete calendarClaims[username];
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                currentUser.username = newUsername;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
            if (newPhone) {
                users[currentUser.username].phoneNumber = newPhone;
                currentUser.phoneNumber = newPhone;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∏–æ
            if (newBio) {
                userProfiles[currentUser.username].bio = newBio;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞
            if (avatarFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    userProfiles[currentUser.username].avatar = e.target.result;
                    saveAllData();
                    showNotification('–ü—Ä–æ—Ñ–∏–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!');
                    showProfile();
                };
                reader.readAsDataURL(avatarFile);
            } else {
                saveAllData();
                showNotification('–ü—Ä–æ—Ñ–∏–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!');
                showProfile();
            }
            
            updateUIForUser();
            return true;
        }

        // –ú–∞–≥–∞–∑–∏–Ω
        function showShopCategory(category) {
            document.querySelectorAll('.shop-category').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.querySelector(`.shop-category[data-category="${category}"]`).classList.add('active');
            
            const container = document.getElementById('shopItemsContainer');
            container.innerHTML = '';
            
            const items = shopItems[category] || [];
            
            if (items.length === 0) {
                container.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #aaa;">–¢–æ–≤–∞—Ä—ã –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>';
                return;
            }
            
            items.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'shop-item';
                itemElement.onclick = () => buyItem(item, category);
                
                let itemContent = `
                    <div class="shop-item-name">${item.name}</div>
                    <div class="shop-item-price">
                        <i class="fas fa-coins"></i> ${item.price}
                    </div>
                    <div class="shop-item-description">${item.description}</div>
                `;
                
                if (item.emoji) {
                    itemContent = `<div class="gift-emoji" style="font-size: 3rem; text-align: center; margin-bottom: 1rem;">${item.emoji}</div>` + itemContent;
                }
                
                itemElement.innerHTML = itemContent;
                container.appendChild(itemElement);
            });
        }

        function buyItem(item, category) {
            if (!currentUser) {
                showNotification('–î–ª—è –ø–æ–∫—É–ø–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É', true);
                return;
            }
            
            const username = currentUser.username;
            const balance = userScoins[username] || 0;
            
            if (balance < item.price) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∫–æ–∏–Ω–æ–≤ –¥–ª—è –ø–æ–∫—É–ø–∫–∏!', true);
                return;
            }
            
            // –°–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤
            userScoins[username] = balance - item.price;
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞
            if (category === 'gifts') {
                userGifts[username].push({
                    id: item.id,
                    name: item.name,
                    emoji: item.emoji,
                    purchasedAt: new Date().toISOString()
                });
            } else if (category === 'badges') {
                userBadges[username].push({
                    id: item.id,
                    name: item.name,
                    purchasedAt: new Date().toISOString()
                });
            } else if (category === 'premium') {
                const duration = parseInt(item.id.replace('premium', ''));
                activatePremium(username, duration);
            }
            
            saveAllData();
            updateScoinDisplay();
            showNotification(`–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–æ–±—Ä–µ–ª–∏ "${item.name}"!`);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏
            document.getElementById('scoinBalance').classList.add('coin-animation');
            setTimeout(() => {
                document.getElementById('scoinBalance').classList.remove('coin-animation');
            }, 500);
        }

        function activatePremium(username, months) {
            const currentPremium = userPremium[username] || { active: false, expires: null };
            const now = new Date();
            
            if (currentPremium.active && new Date(currentPremium.expires) > now) {
                // –ü—Ä–æ–¥–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–µ–º–∏—É–º–∞
                const newExpiry = new Date(currentPremium.expires);
                newExpiry.setMonth(newExpiry.getMonth() + months);
                userPremium[username] = {
                    active: true,
                    expires: newExpiry.toISOString()
                };
            } else {
                // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–µ–º–∏—É–º–∞
                const expiry = new Date();
                expiry.setMonth(expiry.getMonth() + months);
                userPremium[username] = {
                    active: true,
                    expires: expiry.toISOString()
                };
            }
            
            showNotification(`–ü—Ä–µ–º–∏—É–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–∞ ${months} –º–µ—Å—è—Ü(–µ–≤)!`);
            updateUIForUser();
        }

        // –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä —Å –ø–æ–∏—Å–∫–æ–º
        function loadContacts() {
            if (!currentUser) return;
            
            const contactsList = document.getElementById('contactsList');
            const searchInput = document.getElementById('searchContacts');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞
            searchInput.addEventListener('input', function() {
                filterContacts(this.value);
            });
            
            filterContacts('');
        }

        function filterContacts(searchTerm) {
            const contactsList = document.getElementById('contactsList');
            contactsList.innerHTML = '';
            
            const userMessages = messages[currentUser.username] || {};
            let contacts = Object.keys(userMessages);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            Object.keys(users).forEach(username => {
                if (username !== currentUser.username && !contacts.includes(username)) {
                    contacts.push(username);
                }
            });
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–∏—Å–∫—É
            if (searchTerm) {
                contacts = contacts.filter(contact => 
                    contact.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }
            
            const uniqueContacts = [...new Set(contacts)];
            
            if (uniqueContacts.length === 0) {
                contactsList.innerHTML = '<div class="contact" style="justify-content: center; color: #aaa;">–ö–æ–Ω—Ç–∞–∫—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            uniqueContacts.forEach(contact => {
                const contactElement = document.createElement('div');
                contactElement.className = 'contact';
                
                const profile = userProfiles[contact] || {};
                const avatar = profile.avatar || '';
                const lastMessage = getLastMessage(contact);
                
                contactElement.innerHTML = `
                    <img class="contact-avatar" src="${avatar || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjIwIiB5PSIyMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+8J+OujwvdGV4dD4KPC9zdmc+'}" alt="Avatar">
                    <div class="contact-info">
                        <div class="contact-name">${contact}</div>
                        <div class="contact-status">${lastMessage}</div>
                    </div>
                `;
                
                contactElement.onclick = () => {
                    document.querySelectorAll('.contact').forEach(c => c.classList.remove('active'));
                    contactElement.classList.add('active');
                    openChat(contact);
                };
                
                contactsList.appendChild(contactElement);
            });
        }

        function getLastMessage(contact) {
            const userMessages = messages[currentUser.username] || {};
            const contactMessages = userMessages[contact] || [];
            
            if (contactMessages.length === 0) {
                return '–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π';
            }
            
            const lastMessage = contactMessages[contactMessages.length - 1];
            return lastMessage.text.length > 30 ? lastMessage.text.substring(0, 30) + '...' : lastMessage.text;
        }

        function openChat(contact) {
            currentChat = contact;
            
            const profile = userProfiles[contact] || {};
            const avatar = profile.avatar || '';
            
            document.getElementById('chatUserName').textContent = contact;
            document.getElementById('chatUserStatus').textContent = '–í —Å–µ—Ç–∏';
            document.getElementById('chatAvatar').src = avatar || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjIwIiB5PSIyMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+8J+OujwvdGV4dD4KPC9zdmc+';
            
            document.getElementById('messageInput').disabled = false;
            document.getElementById('sendMessageBtn').disabled = false;
            
            loadMessages(contact);
        }

        function loadMessages(contact) {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = '';
            
            const userMessages = messages[currentUser.username] || {};
            const contactMessages = userMessages[contact] || [];
            
            if (contactMessages.length === 0) {
                messagesContainer.innerHTML = '<p style="text-align: center; color: #aaa; margin-top: 2rem;">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π. –ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ!</p>';
                return;
            }
            
            contactMessages.forEach(msg => {
                const messageElement = document.createElement('div');
                messageElement.className = `message ${msg.sender === currentUser.username ? 'sent' : 'received'}`;
                
                messageElement.innerHTML = `
                    ${msg.sender !== currentUser.username ? `<div class="message-sender">${msg.sender}</div>` : ''}
                    <div class="message-text">${msg.text}</div>
                    <div class="message-time">${formatTime(msg.timestamp)}</div>
                `;
                
                messagesContainer.appendChild(messageElement);
            });
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function sendMessage() {
            if (!currentUser || !currentChat) return;
            
            const messageInput = document.getElementById('messageInput');
            const text = messageInput.value.trim();
            
            if (!text) return;
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            if (!messages[currentUser.username]) {
                messages[currentUser.username] = {};
            }
            
            if (!messages[currentUser.username][currentChat]) {
                messages[currentUser.username][currentChat] = [];
            }
            
            if (!messages[currentChat]) {
                messages[currentChat] = {};
            }
            
            if (!messages[currentChat][currentUser.username]) {
                messages[currentChat][currentUser.username] = [];
            }
            
            const message = {
                text: text,
                sender: currentUser.username,
                timestamp: new Date().toISOString()
            };
            
            messages[currentUser.username][currentChat].push(message);
            messages[currentChat][currentUser.username].push(message);
            
            saveAllData();
            
            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
            messageInput.value = '';
            loadMessages(currentChat);
            
            // –ê–≤—Ç–æ–æ—Ç–≤–µ—Ç –±–æ—Ç–∞
            if (currentChat === 'PastBinBot') {
                setTimeout(() => {
                    const botResponses = [
                        '–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç PastBin. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?',
                        '–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!',
                        '–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!',
                        '–ö–∞–∫ –≤–∞—à–∏ –¥–µ–ª–∞?',
                        '–†–∞–¥ –æ–±—â–µ–Ω–∏—é —Å –≤–∞–º–∏!'
                    ];
                    
                    const randomResponse = botResponses[Math.floor(Math.random() * botResponses.length)];
                    
                    const botMessage = {
                        text: randomResponse,
                        sender: 'PastBinBot',
                        timestamp: new Date().toISOString()
                    };
                    
                    messages[currentUser.username][currentChat].push(botMessage);
                    messages[currentChat][currentUser.username].push(botMessage);
                    
                    saveAllData();
                    loadMessages(currentChat);
                }, 1000);
            }
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp);
            return `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
        }

        // –ü–æ—Å—Ç—ã
        function showCreatePostModal() {
            document.getElementById('createPostModal').classList.remove('hidden');
        }

        function loadUserPosts() {
            if (!currentUser) return;
            
            const container = document.getElementById('postsContainer');
            const userPosts = posts[currentUser.username] || [];
            
            if (userPosts.length === 0) {
                container.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #aaa;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</p>';
                return;
            }
            
            container.innerHTML = '';
            
            userPosts.forEach((post, index) => {
                const postElement = document.createElement('div');
                postElement.className = 'post-card';
                
                postElement.innerHTML = `
                    <div class="post-title">${post.title}</div>
                    <div class="post-content">${post.content}</div>
                    <div class="post-meta">
                        <span>${formatDate(post.createdAt)}</span>
                        <span>
                            <button onclick="deletePost(${index})" style="background: transparent; border: none; color: #ff4444; padding: 0; font-size: 0.8rem;">
                                <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </span>
                    </div>
                `;
                
                container.appendChild(postElement);
            });
        }

        function createPost(title, content) {
            if (!currentUser) return;
            
            const username = currentUser.username;
            
            if (!posts[username]) {
                posts[username] = [];
            }
            
            const post = {
                title: title,
                content: content,
                createdAt: new Date().toISOString()
            };
            
            posts[username].unshift(post);
            saveAllData();
            
            showNotification('–ü–æ—Å—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!');
            closeModal('createPostModal');
            loadUserPosts();
        }

        function deletePost(index) {
            if (!currentUser) return;
            
            const username = currentUser.username;
            
            if (posts[username] && posts[username][index]) {
                posts[username].splice(index, 1);
                saveAllData();
                showNotification('–ü–æ—Å—Ç —É–¥–∞–ª–µ–Ω!');
                loadUserPosts();
            }
        }

        function formatDate(timestamp) {
            const date = new Date(timestamp);
            return `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
        }

        // –ö–∞–ª–µ–Ω–¥–∞—Ä—å
        function loadCalendar() {
            if (!currentUser) return;
            
            const username = currentUser.username;
            const isPremium = userPremium[username]?.active || false;
            const calendarInfo = document.getElementById('calendarInfo');
            const calendarContainer = document.getElementById('calendarContainer');
            
            if (!isPremium) {
                calendarInfo.innerHTML = '<p style="color: #ff4444;">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–µ–º–∏—É–º-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π!</p>';
                calendarContainer.innerHTML = '';
                return;
            }
            
            calendarInfo.innerHTML = '<p>–û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –Ω–∞–≥—Ä–∞–¥—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å! –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–µ–º–∏—É–º-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>';
            
            const userClaims = calendarClaims[username] || { lastClaim: null, claimedDays: [] };
            const today = new Date().toDateString();
            const lastClaimDate = userClaims.lastClaim ? new Date(userClaims.lastClaim).toDateString() : null;
            const canClaimToday = lastClaimDate !== today;
            
            calendarContainer.innerHTML = '';
            
            calendarRewards.forEach(reward => {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                const isClaimed = userClaims.claimedDays.includes(reward.day);
                const isToday = reward.day === getCurrentDay();
                const isAvailable = isToday && canClaimToday && !isClaimed;
                const isFuture = reward.day > getCurrentDay();
                
                if (isClaimed) {
                    dayElement.classList.add('claimed');
                } else if (isAvailable) {
                    dayElement.classList.add('available');
                } else if (isFuture) {
                    dayElement.classList.add('future');
                }
                
                dayElement.innerHTML = `
                    <div class="day-number">${reward.day}</div>
                    <div class="day-reward">${reward.reward}</div>
                `;
                
                if (isAvailable) {
                    dayElement.onclick = () => claimReward(reward);
                }
                
                calendarContainer.appendChild(dayElement);
            });
        }

        function getCurrentDay() {
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
            return new Date().getDate() % 7 || 7;
        }

        function claimReward(reward) {
            if (!currentUser) return;
            
            const username = currentUser.username;
            const userClaims = calendarClaims[username] || { lastClaim: null, claimedDays: [] };
            
            // –û—Ç–º–µ—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥—ã
            userClaims.lastClaim = new Date().toISOString();
            userClaims.claimedDays.push(reward.day);
            calendarClaims[username] = userClaims;
            
            // –í—ã–¥–∞—á–∞ –Ω–∞–≥—Ä–∞–¥—ã
            if (reward.type === 'scoins') {
                userScoins[username] = (userScoins[username] || 0) + reward.value;
                showNotification(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${reward.value} —Å–∫–æ–∏–Ω–æ–≤!`);
            } else if (reward.type === 'gift') {
                const count = reward.count || 1;
                for (let i = 0; i < count; i++) {
                    userGifts[username].push({
                        id: reward.value,
                        name: reward.reward,
                        emoji: getGiftEmoji(reward.value),
                        claimedAt: new Date().toISOString()
                    });
                }
                showNotification(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${count} ${reward.reward}!`);
            } else if (reward.type === 'premium') {
                activatePremium(username, reward.value);
            }
            
            saveAllData();
            updateScoinDisplay();
            loadCalendar();
        }

        function getGiftEmoji(giftId) {
            const gift = shopItems.gifts.find(item => item.id === giftId);
            return gift ? gift.emoji : 'üéÅ';
        }

        // –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
        function updateAdminPanel() {
            if (!currentUser || users[currentUser.username]?.role !== 'admin') return;
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            const totalScoins = Object.values(userScoins).reduce((sum, scoin) => sum + scoin, 0);
            const totalUsers = Object.keys(users).length;
            const totalMessages = Object.values(messages).reduce((sum, userMsg) => {
                return sum + Object.values(userMsg).reduce((userSum, chat) => userSum + chat.length, 0);
            }, 0);
            const totalPosts = Object.values(posts).reduce((sum, userPosts) => sum + userPosts.length, 0);
            
            document.getElementById('totalScoins').textContent = totalScoins;
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('totalMessages').textContent = totalMessages;
            document.getElementById('totalPosts').textContent = totalPosts;
            
            // –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = '';
            
            Object.keys(users).forEach(username => {
                const userElement = document.createElement('div');
                userElement.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 1rem; border-bottom: 1px solid #222;';
                
                const userInfo = document.createElement('div');
                userInfo.innerHTML = `
                    <div style="font-weight: bold;">${username}</div>
                    <div style="font-size: 0.8rem; color: #aaa;">
                        –°–∫–æ–∏–Ω—ã: ${userScoins[username] || 0} | 
                        –ü—Ä–µ–º–∏—É–º: ${userPremium[username]?.active ? '–î–∞' : '–ù–µ—Ç'} |
                        –†–æ–ª—å: ${users[username].role}
                    </div>
                `;
                
                const userActions = document.createElement('div');
                userActions.style.cssText = 'display: flex; gap: 0.5rem;';
                userActions.innerHTML = `
                    <button onclick="showGiveScoinsToUser('${username}')" style="padding: 0.5rem; font-size: 0.8rem;">
                        <i class="fas fa-coins"></i>
                    </button>
                    <button onclick="showGivePremiumToUser('${username}')" class="btn-premium" style="padding: 0.5rem; font-size: 0.8rem;">
                        <i class="fas fa-crown"></i>
                    </button>
                `;
                
                userElement.appendChild(userInfo);
                userElement.appendChild(userActions);
                usersList.appendChild(userElement);
            });
        }

        function showGiveScoinsModal() {
            document.getElementById('giveScoinsModal').classList.remove('hidden');
        }

        function showGivePremiumModal() {
            document.getElementById('givePremiumModal').classList.remove('hidden');
        }

        function showGiveScoinsToUser(username) {
            document.getElementById('scoinRecipient').value = username;
            showGiveScoinsModal();
        }

        function showGivePremiumToUser(username) {
            document.getElementById('premiumRecipient').value = username;
            showGivePremiumModal();
        }

        function giveScoins() {
            const recipient = document.getElementById('scoinRecipient').value.trim();
            const amount = parseInt(document.getElementById('scoinAmount').value);
            
            if (!users[recipient]) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!', true);
                return;
            }
            
            if (isNaN(amount) || amount <= 0) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–æ–∏–Ω–æ–≤!', true);
                return;
            }
            
            userScoins[recipient] = (userScoins[recipient] || 0) + amount;
            saveAllData();
            
            showNotification(`–í—ã–¥–∞–ª–∏ ${amount} —Å–∫–æ–∏–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${recipient}!`);
            closeModal('giveScoinsModal');
            updateAdminPanel();
        }

        function givePremium() {
            const recipient = document.getElementById('premiumRecipient').value.trim();
            const duration = parseInt(document.getElementById('premiumDuration').value);
            
            if (!users[recipient]) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!', true);
                return;
            }
            
            if (isNaN(duration) || duration <= 0) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å!', true);
                return;
            }
            
            activatePremium(recipient, duration);
            closeModal('givePremiumModal');
            updateAdminPanel();
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
        function showAccountsModal() {
            document.getElementById('accountsModal').classList.remove('hidden');
            loadAccountsList();
        }

        function loadAccountsList() {
            const accountsList = document.getElementById('accountsList');
            accountsList.innerHTML = '';
            
            Object.values(userAccounts).forEach(account => {
                const accountElement = document.createElement('div');
                accountElement.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 1rem; border-bottom: 1px solid #222;';
                
                accountElement.innerHTML = `
                    <div>
                        <div style="font-weight: bold;">${account.username}</div>
                        <div style="font-size: 0.8rem; color: #aaa;">${account.phoneNumber} | ${account.role}</div>
                    </div>
                    <button onclick="switchAccount('${account.username}')" ${account.username === currentUser?.username ? 'disabled' : ''}>
                        ${account.username === currentUser?.username ? '–¢–µ–∫—É—â–∏–π' : '–í—ã–±—Ä–∞—Ç—å'}
                    </button>
                `;
                
                accountsList.appendChild(accountElement);
            });
        }

        function switchAccount(username) {
            if (users[username]) {
                currentUser = {
                    username: username,
                    phoneNumber: users[username].phoneNumber,
                    role: users[username].role
                };
                
                localStorage.setItem('pastbin_current_user', JSON.stringify(currentUser));
                updateUIForUser();
                showProfile();
                closeModal('accountsModal');
                showNotification(`–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç ${username}`);
            }
        }

        function createNewAccount() {
            const phoneNumber = document.getElementById('newPhoneNumber').value.trim();
            const username = document.getElementById('newUsername').value.trim();
            
            if (!phoneNumber || !username) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', true);
                return;
            }
            
            if (users[username]) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', true);
                return;
            }
            
            const existingUser = Object.values(users).find(user => user.phoneNumber === phoneNumber);
            if (existingUser) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –Ω–æ–º–µ—Ä–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', true);
                return;
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è
            const password = Math.random().toString(36).slice(-8);
            
            users[username] = {
                password: password,
                phoneNumber: phoneNumber,
                role: 'user',
                createdAt: new Date().toISOString()
            };
            
            userProfiles[username] = {
                avatar: '',
                bio: '',
                level: 1
            };
            
            const accountId = 'acc_' + Date.now();
            userAccounts[accountId] = {
                id: accountId,
                phoneNumber: phoneNumber,
                username: username,
                role: 'user',
                createdAt: new Date().toISOString()
            };
            
            initUserData(username);
            saveAllData();
            
            showNotification(`–°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç: ${username} —Å –ø–∞—Ä–æ–ª–µ–º: ${password}`);
            loadAccountsList();
            
            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π
            document.getElementById('newPhoneNumber').value = '';
            document.getElementById('newUsername').value = '';
        }

        // –£—Ç–∏–ª–∏—Ç—ã
        function logout() {
            currentUser = null;
            localStorage.removeItem('pastbin_current_user');
            updateUIForUser();
            showWelcome();
            showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
        }

        function showNotification(message, isError = false) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 1rem 1.5rem;
                background: ${isError ? '#ff4444' : '#00c851'};
                color: white;
                border-radius: 8px;
                z-index: 10000;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        function resetAllData() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                localStorage.clear();
                location.reload();
            }
        }

        function createTestData() {
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (!users['TestUser']) {
                users['TestUser'] = {
                    password: 'test123',
                    phoneNumber: '+79998887766',
                    role: 'user',
                    createdAt: new Date().toISOString()
                };
                
                userScoins['TestUser'] = 500;
                userProfiles['TestUser'] = {
                    avatar: '',
                    bio: '–¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                    level: 1
                };
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞
                users['PastBinBot'] = {
                    password: 'botpassword',
                    phoneNumber: '+70000000000',
                    role: 'bot',
                    createdAt: new Date().toISOString()
                };
                
                userProfiles['PastBinBot'] = {
                    avatar: '',
                    bio: '–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –±–æ—Ç PastBin',
                    level: 1
                };
                
                saveAllData();
                showNotification('–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã!');
                updateAdminPanel();
            } else {
                showNotification('–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç!');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            createAdminUser();
            
            if (currentUser) {
                initUserData(currentUser.username);
                updateUIForUser();
            } else {
                showWelcome();
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–æ—Ä–º
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                login(username, password);
            });
            
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('registerUsername').value;
                const password = document.getElementById('registerPassword').value;
                const phone = document.getElementById('registerPhone').value;
                register(username, password, phone);
            });
            
            document.getElementById('editProfileForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveProfileChanges();
            });
            
            document.getElementById('createPostForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const title = document.getElementById('postTitle').value;
                const content = document.getElementById('postContent').value;
                createPost(title, content);
            });
            
            document.getElementById('sendMessageBtn').addEventListener('click', sendMessage);
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });
            
            document.getElementById('userInfo').addEventListener('click', function(e) {
                e.stopPropagation();
                document.getElementById('userMenu').classList.toggle('hidden');
            });
            
            document.getElementById('loginBtn').addEventListener('click', showLogin);
            document.getElementById('registerBtn').addEventListener('click', showRegister);
            document.getElementById('addPasteBtn').addEventListener('click', showCreatePostModal);
            
            document.addEventListener('click', function() {
                document.getElementById('userMenu').classList.add('hidden');
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –º–∞–≥–∞–∑–∏–Ω–∞
            document.querySelectorAll('.shop-category').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const category = e.target.getAttribute('data-category');
                    showShopCategory(category);
                });
            });
        });
    </script>
</body>
  </html>
